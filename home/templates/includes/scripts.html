{% load static %}
<!-- Core CSS Dependencies -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous">
<!-- Font Awesome Icons -->
<link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
<!-- DataTables CSS -->
<link rel="stylesheet"
      href="https://cdn.datatables.net/2.1.8/css/dataTables.dataTables.min.css" />
<!-- Custom CSS -->
<link rel="stylesheet" href="{% static 'css/custom.css' %}" />
<!-- JavaScript Dependencies -->
<!-- jQuery (required for DataTables and some plugins) -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- Bootstrap JS Bundle (includes Popper) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
<!-- DataTables JS -->
<script src="https://cdn.datatables.net/2.1.8/js/dataTables.min.js"></script>
<!-- Your Custom JavaScript -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
  const sidebar = document.getElementById('sidebar');
  const sidebarCollapse = document.getElementById('sidebarCollapse');
  const body = document.body;

  function setSidebarState() {
    let isMinimized = localStorage.getItem('sidebarMinimized');
    if (isMinimized === null) {
      isMinimized = 'false';
      localStorage.setItem('sidebarMinimized', isMinimized);
    }

    // Apply minimized or expanded *while* still in preload (no transitions):
    if (isMinimized === 'true') {
      sidebar.classList.add('minimized');
      body.classList.add('sidebar-minimized');
    } else {
      sidebar.classList.remove('minimized');
      body.classList.remove('sidebar-minimized');
    }
  }

  // Set sidebar state before removing preload to prevent animation
  setSidebarState();

  // Small delay to ensure styles are applied before enabling transitions
  requestAnimationFrame(() => {
    body.classList.remove('preload');
  });

  if (sidebar && sidebarCollapse) {
    sidebarCollapse.addEventListener('click', function() {
      sidebar.classList.toggle('minimized');
      body.classList.toggle('sidebar-minimized');
      localStorage.setItem(
        'sidebarMinimized',
        sidebar.classList.contains('minimized')
      );
    });
  }
});

</script>
